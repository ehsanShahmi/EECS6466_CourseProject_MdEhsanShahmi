    if not (isinstance(P, np.ndarray) and isinstance(T, np.ndarray)):
        raise TypeError("Expected inputs to be numpy arrays")

    # Compute the matrix-tensor product to ensure the result has the desired shape
    result = np.einsum("ij,jkl->ik", P, T)

    # Visualize the result in 3D
    fig = plt.figure()
    ax = fig.add_subplot(111, projection="3d")
    ax.scatter(result[:, 0], result[:, 1], result[:, 2])

    # Return the result and the 3D visualization
    return result, ax