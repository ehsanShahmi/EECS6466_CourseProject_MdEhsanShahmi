    # Normalize spaces and remove punctuation
    text = re.sub(r'[^\w\s]', '', text)  # Remove all punctuation
    text = re.sub(r'\s+', ' ', text)  # Normalize whitespace

    # Filter out stopwords and split into words
    words = [word.lower() for word in text.split() if word.lower() not in STOPWORDS]

    # Generate n-grams
    ngrams = zip(*[words[i:] for i in range(n)])

    return Counter(ngrams)