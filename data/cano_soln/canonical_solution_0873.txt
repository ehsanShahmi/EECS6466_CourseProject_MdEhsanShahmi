    if file_path is None:
        raise ValueError("The file path is invalid.")

    with open(file_path, 'w', newline='') as csvfile:
        writer = csv.writer(csvfile)
        writer.writerow(headers)
        for row in data:
            if len(row) < len(headers):
                row += (None,) * (len(headers) - len(row))
            writer.writerow(row)
    return os.path.abspath(file_path)