    result = {}

    # Scan the CSV files in the directory
    for filename in os.listdir(csv_dir):
        if filename.endswith('.csv'):
            with open(os.path.join(csv_dir, filename), 'r') as f:
                reader = csv.reader(f)
                for i, row in enumerate(reader):
                    if row[0] == target_value:
                        result[filename] = i
                        break

            # Move the file to the processed directory if not simulating
            if not simulate:
                shutil.move(os.path.join(csv_dir, filename), processed_dir)
    
    return result